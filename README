### installation with GIT
# 1) make sure you have set-up the CMSSW environment
cmsrel CMSSW_5_3_3 # or newer from 53x family
cd CMSSW_5_3_3/src/
cmsenv


# 2) checkout and compile analysis code 
git clone git@github.com:jpavel/cms-ucl-tau.git .
cd SFrame/
source setup.sh
make
cd ../ZHtautauAnalysis/
make
cd ..

# 3) compile FWlite code for di-tau mass reco
cd TauAnalysis/CandidateTools/
emacs -nw bin/nsvfitStandalone.cc 
scram b -j 9
cd ../../
cmsenv # important to do after every recompillation

# 4) RUN! (change input file defined in Analysis_config.xml appropriatelly)
cd ZHtautauAnalysis/config
sframe-main  Analysis_config.xml 



########### misc (see http://git-scm.com/book for more help)
## adress of a git repository
https://git.cern.ch/web/?p=cms-ucl-tau.git;a=summary #for browsing via web
#for downloading the code
https://<USER>@git.cern.ch/kerberos/cms-ucl-tau #With valid kerberos credentials
https://git.cern.ch/reps/cms-ucl-tau #LDAP authentication

## 

## Obtaining Kerberos ticket from CERN for 24h password-less access to CERN
# use setup described e.g. here: http://david.decotigny.free.fr/wiki/wakka.php?wiki=AfsOnUbuntu
kinit <AFSuserName>@CERN.CH

##making a lightweight tag 
git tag v1.4

### making an annotated tag (recommended) 
git tag -a v1.4 -m "making tag v1.4" 

## switching to a new tag or branch
git checkout v1.4

## create new branch
git branch myNewBranch

## switch to branch
git checkout myNewBranch

## pushing to a server
git push

## review status of work directory
git status

## adding remote repository (on top of origin that is defined automatically if you use clone as above)

git remote add <MyRepositoryNickname> <MyRepositoryURL> # e.g. git remote add pb git://github.com/paulboone/ticgit.git

## check what is new in the repository (pushes by other users)
git fetch # it is possible to specify repository nickname as a first argument. This command will not do anything with your local repository, only inform about changes in the remote

## update your local repository and merge with remote
git pull # if merging is not possible due to conflicts, git will inform you

## inspecting a remote
git remote show origin
 
##################################
## Running at ULB cluster 
##################################
ssh m2.iihe.ac.be # connect without password
source $VO_CMS_SW_DIR/cmsset_default.sh # basic cms environment
cmsrel CMSSW_5_3_3_patch3 #prepare the CMSSW area
# Standard stuff
cd CMSSW_5_3_3_patch3/src/
cmsenv 

# checkout and compile SFRAME and analysis as above

# make grid proxy (.globus with certificate necesssary at home dir)
voms-proxy-init --voms cms:/cms/becms

# define input in Analysis_config.xml - If the location is e.g. /pnfs/iihe/cms/store/user/jez/ZHTo2TauAna_52x_test0/output_Ntuples_10_1_rCX.root, the input file tag should read
# <In FileName="dcap://maite.iihe.ac.be/pnfs/iihe/cms/store/user/jez/ZHTo2TauAna_52x_test0/output_Ntuples_10_1_rCX.root"  Lumi="1.0" />

# RUN! 
cd config
sframe-main  Analysis_config.xml
